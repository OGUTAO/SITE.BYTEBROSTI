<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja de Pe√ßas - Byte Bros</title>
    <link rel="stylesheet" href="css/style7.css">
    </head>
<body>
    <div class="container">
        <div class="top-buttons-container">
            <a href="lojapecasADM.html" class="button back-button">ADM</a>
            <a href="index.html" class="button back-button">Menu</a>
            <button id="theme-toggle" class="button theme-toggle-button" title="Alternar Tema">
                </button>
        </div>

        <h2>Nossa Loja de Pe√ßas</h2>

        <ul class="product-list"></ul>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Seletores ---
            const productList = document.querySelector('.product-list');
            const themeToggleButton = document.getElementById('theme-toggle'); // Seleciona o NOVO bot√£o

            // --- L√≥gica do Tema Claro/Escuro ---
            const sunIcon = '‚òÄÔ∏è'; // √çcone Sol
            const moonIcon = 'üåô'; // √çcone Lua

            function setTheme(theme) { // Nome padr√£o da fun√ß√£o
                if (theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    if (themeToggleButton) themeToggleButton.innerHTML = sunIcon;
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.classList.remove('dark-mode');
                    if (themeToggleButton) themeToggleButton.innerHTML = moonIcon;
                    localStorage.setItem('theme', 'light');
                }
                // Adicione aqui qualquer outra l√≥gica que precise rodar na troca de tema na p√°gina do cliente
            }

            function toggleTheme() { // Nome padr√£o da fun√ß√£o
                if (document.body.classList.contains('dark-mode')) {
                    setTheme('light');
                } else {
                    setTheme('dark');
                }
            }

            function loadTheme() { // Nome padr√£o da fun√ß√£o
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

                if (savedTheme) {
                    setTheme(savedTheme);
                } else if (prefersDark) {
                    setTheme('dark');
                } else {
                    setTheme('light'); // Padr√£o
                }
            }
            // --- Fim da L√≥gica do Tema ---


            // --- L√≥gica de Produtos (Carregamento e Renderiza√ß√£o) ---
            function loadProductsFromLocalStorage() {
                const storedProducts = localStorage.getItem('products');
                return storedProducts ? JSON.parse(storedProducts) : [];
            }

            function renderClientProducts(productsToRender) {
                productList.innerHTML = ''; // Limpa antes de renderizar
                if (!productsToRender || productsToRender.length === 0) {
                     productList.innerHTML = '<li class="no-products-message">Nenhuma pe√ßa dispon√≠vel no momento.</li>';
                     return;
                }

                productsToRender.forEach((product, index) => {
                    // Verifica se o produto tem quantidade > 0 antes de renderizar para o cliente
                    if (product.quantity > 0) {
                        const listItem = document.createElement('li');
                        listItem.classList.add('product-item'); // Usar a mesma classe base pode ajudar na estiliza√ß√£o
                        listItem.dataset.productId = product.id || index; // Usa ID se dispon√≠vel

                        const valueAsNumber = parseFloat(product.value);
                        const formattedValue = !isNaN(valueAsNumber)
                            ? valueAsNumber.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })
                            : 'Valor Indispon√≠vel';

                        listItem.innerHTML = `
                            <div class="product-image-container">
                                <img src="${product.image || 'img/default_product.jpg'}" alt="${product.name || 'Produto'}" class="product-image">
                            </div>
                            <div class="product-info">
                                <h3 class="product-name">${product.name || 'Nome Indispon√≠vel'}</h3>
                                <p class="product-details">${product.details || ''}</p>
                                <div class="product-price-quantity">
                                    <span class="product-price">${formattedValue}</span>
                                    <span class="product-quantity">Dispon√≠vel: ${product.quantity}</span>
                                </div>
                            </div>
                            <button class="button add-to-cart-button" data-product-id="${product.id || index}" data-product-name="${product.name || ''}" data-product-value="${product.value || 0}">Adicionar ao Carrinho</button>
                        `;
                        productList.appendChild(listItem);
                    }
                });

                // Adiciona listeners aos bot√µes de carrinho rec√©m-criados
                attachCartEventListeners();
            }

            function attachCartEventListeners() {
                 const addToCartButtons = document.querySelectorAll('.add-to-cart-button');
                 addToCartButtons.forEach(button => {
                     // Remove listener antigo para seguran√ßa (embora limpar innerHTML geralmente resolva)
                     button.removeEventListener('click', handleAddToCart);
                     button.addEventListener('click', handleAddToCart);
                 });
            }

            function handleAddToCart(event) {
                const button = event.currentTarget;
                const productId = button.dataset.productId;
                const productName = button.dataset.productName;
                const productValue = button.dataset.productValue;
                console.log(`Produto adicionado ao carrinho: ID=${productId}, Nome="${productName}", Valor=R$${productValue}`);
                alert(`"${productName}" (R$${productValue}) adicionado ao carrinho! (Funcionalidade de carrinho real a ser implementada)`);
                // Aqui voc√™ implementaria a l√≥gica real do carrinho (ex: salvar no localStorage, atualizar UI do carrinho)
            }

            // --- Inicializa√ß√£o ---
            if (themeToggleButton) {
                themeToggleButton.addEventListener('click', toggleTheme);
            } else {
                console.warn("Bot√£o de tema #theme-toggle n√£o encontrado.");
            }

            loadTheme(); // Carrega o tema ao iniciar

            const products = loadProductsFromLocalStorage();
            renderClientProducts(products); // Carrega e renderiza os produtos

        }); // Fim do DOMContentLoaded
    </script>
</body>
</html>